{"version":3,"file":"index.js","names":["_react","_interopRequireDefault","require","_reactRedux","_propTypes","_paragon","_i18n","_redux","_requests","_EditorContainer","_RawEditor","hooks","_interopRequireWildcard","_messages","_TinyMceWidget","_hooks2","_jsxRuntime","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","_typeof","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","Symbol","iterator","constructor","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","toPrimitive","undefined","res","TypeError","Number","TextEditor","exports","_ref","onClose","isRaw","blockValue","blockFailed","initializeEditor","assetsFinished","assets","intl","_prepareEditorRef","prepareEditorRef","editorRef","refReady","setEditorRef","selectEditor","jsx","content","editorType","textValue","data","minHeight","height","getContent","children","jsxs","className","Toast","show","nullMethod","FormattedMessage","messages","couldNotLoadTextContext","Spinner","animation","screenreadertext","formatMessage","spinnerScreenReaderText","defaultProps","propTypes","PropTypes","func","isRequired","shape","string","bool","intlShape","mapStateToProps","state","selectors","app","requests","isFailed","requestKey","RequestKeys","fetchBlock","isFinished","fetchAssets","mapDispatchToProps","actions","_default","injectIntl","connect"],"sources":["../../../../src/editors/containers/TextEditor/index.jsx"],"sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\n\nimport {\n  Spinner,\n  Toast,\n} from '@edx/paragon';\nimport { FormattedMessage, injectIntl, intlShape } from '@edx/frontend-platform/i18n';\n\nimport { actions, selectors } from '../../data/redux';\nimport { RequestKeys } from '../../data/constants/requests';\n\nimport EditorContainer from '../EditorContainer';\nimport RawEditor from '../../sharedComponents/RawEditor';\nimport * as hooks from './hooks';\nimport messages from './messages';\nimport TinyMceWidget from '../../sharedComponents/TinyMceWidget';\nimport { prepareEditorRef } from '../../sharedComponents/TinyMceWidget/hooks';\n\nexport const TextEditor = ({\n  onClose,\n  // redux\n  isRaw,\n  blockValue,\n  blockFailed,\n  initializeEditor,\n  assetsFinished,\n  assets,\n  // inject\n  intl,\n}) => {\n  const { editorRef, refReady, setEditorRef } = prepareEditorRef();\n\n  if (!refReady) { return null; }\n\n  const selectEditor = () => {\n    if (isRaw) {\n      return (\n        <RawEditor\n          editorRef={editorRef}\n          content={blockValue}\n        />\n      );\n    }\n    return (\n      <TinyMceWidget\n        editorType=\"text\"\n        editorRef={editorRef}\n        textValue={blockValue ? blockValue.data.data : ''}\n        setEditorRef={setEditorRef}\n        minHeight={500}\n        height=\"100%\"\n        initializeEditor={initializeEditor}\n      />\n    );\n  };\n\n  return (\n    <EditorContainer\n      getContent={hooks.getContent({ editorRef, isRaw, assets })}\n      onClose={onClose}\n    >\n      <div className=\"editor-body h-75 overflow-auto\">\n        <Toast show={blockFailed} onClose={hooks.nullMethod}>\n          <FormattedMessage {...messages.couldNotLoadTextContext} />\n        </Toast>\n\n        {(!assetsFinished)\n          ? (\n            <div className=\"text-center p-6\">\n              <Spinner\n                animation=\"border\"\n                className=\"m-3\"\n                screenreadertext={intl.formatMessage(messages.spinnerScreenReaderText)}\n              />\n            </div>\n          ) : (selectEditor())}\n      </div>\n    </EditorContainer>\n  );\n};\nTextEditor.defaultProps = {\n  blockValue: null,\n  isRaw: null,\n  assetsFinished: null,\n  assets: null,\n};\nTextEditor.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  // redux\n  blockValue: PropTypes.shape({\n    data: PropTypes.shape({ data: PropTypes.string }),\n  }),\n  blockFailed: PropTypes.bool.isRequired,\n  initializeEditor: PropTypes.func.isRequired,\n  isRaw: PropTypes.bool,\n  assetsFinished: PropTypes.bool,\n  assets: PropTypes.shape({}),\n  // inject\n  intl: intlShape.isRequired,\n};\n\nexport const mapStateToProps = (state) => ({\n  blockValue: selectors.app.blockValue(state),\n  blockFailed: selectors.requests.isFailed(state, { requestKey: RequestKeys.fetchBlock }),\n  isRaw: selectors.app.isRaw(state),\n  assetsFinished: selectors.requests.isFinished(state, { requestKey: RequestKeys.fetchAssets }),\n  assets: selectors.app.assets(state),\n});\n\nexport const mapDispatchToProps = {\n  initializeEditor: actions.app.initializeEditor,\n};\n\nexport default injectIntl(connect(mapStateToProps, mapDispatchToProps)(TextEditor));\n"],"mappings":"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"}